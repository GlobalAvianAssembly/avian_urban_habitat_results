---
title: "R Notebook"
output: html_notebook
---
Run `download_data.Rmd` and `niche_resiliance.Rmd` First!

```{r}
library(randomForest)
library(reshape2)
library(rpart)
```

```{r}
city_data
```

```{r}
fetch_city_niche_data_for <- function(pool_name) {
  results_filename <- paste(paste(pool_name, 'city', 'niche', 'resilience', 'intercept', sep = "_"), "csv", sep = ".")
  results <- read_csv(results_filename)
  
  joined <- left_join(city_data, results)
  
  pool_size_col_name <- paste(pool_name, 'pool', 'size', sep = "_")
  
  joined[,c("response", pool_size_col_name, "population_growth", "rainfall_monthly_min", "rainfall_annual_average", "rainfall_monthly_max", "temperature_annual_average", "temperature_monthly_min", "temperature_monthly_max", "happiness_negative_effect", "happiness_positive_effect", "happiness_future_life", "number_of_biomes", "realm", "biome_name", "region_20km_includes_estuary", "region_50km_includes_estuary", "region_100km_includes_estuary", "city_includes_estuary", "region_20km_average_pop_density", "region_50km_average_pop_density", "region_100km_average_pop_density", "city_max_pop_density", "city_average_pop_density", "mean_population_exposure_to_pm2_5_2019", "region_20km_cultivated", "region_20km_urban", "region_50km_cultivated", "region_50km_urban", "region_100km_cultivated", "region_100km_urban", "region_20km_elevation_delta", "region_20km_mean_elevation", "region_50km_elevation_delta", "region_50km_mean_elevation", "region_100km_elevation_delta", "region_100km_mean_elevation", "city_elevation_delta", "city_mean_elevation", "urban", "shrubs", "permanent_water", "open_forest", "herbaceous_wetland", "herbaceous_vegetation", "cultivated", "closed_forest", "share_of_population_within_400m_of_open_space", "percentage_urban_area_as_streets", "percentage_urban_area_as_open_public_spaces_and_streets", "percentage_urban_area_as_open_public_spaces", "city_gdp_per_population")]
}
```


```{r}
merlin_city_niche_data <- fetch_city_niche_data_for('merlin')
merlin_city_niche_data
```



```{r}
merlin_city_niche_data_fixed <- rfImpute(response ~ ., merlin_city_niche_data)
merlin_city_niche_data_fixed
```


```{r}
source('./random_forest_selection_functions.R')
```

```{r}
select_variables_from_random_forest(merlin_city_niche_data_fixed)
```

```{r}
exclude_merlin_niche <- !names(merlin_city_niche_data_fixed) %in% c(
  "region_50km_urban", "region_20km_urban",
  "region_50km_elevation_delta", "region_100km_elevation_delta", 
  "region_50km_cultivated", "region_20km_cultivated", 
  "region_20km_average_pop_density", "region_50km_average_pop_density", 
  "region_20km_includes_estuary", "region_50km_includes_estuary", "region_100km_includes_estuary", 
  "region_100km_mean_elevation", "region_20km_mean_elevation")

merlin_city_niche_data_fixed_single_scale <- merlin_city_niche_data_fixed[,exclude_merlin_niche]
merlin_city_niche_data_fixed_single_scale
```
```{r}
select_variables_from_random_forest(merlin_city_niche_data_fixed_single_scale)
```


```{r}
create_fifty_rows_of_oob(merlin_city_niche_data_fixed[,c("response", "merlin_pool_size")])
create_fifty_rows_of_oob(merlin_city_niche_data_fixed[,c("response", "merlin_pool_size", "region_100km_cultivated")])
create_fifty_rows_of_oob(merlin_city_niche_data_fixed[,c("response", "merlin_pool_size", "region_100km_cultivated", "region_20km_elevation_delta")])
create_fifty_rows_of_oob(merlin_city_niche_data_fixed[,c("response", "merlin_pool_size", "region_100km_cultivated", "region_20km_elevation_delta", "city_elevation_delta")])
create_fifty_rows_of_oob(merlin_city_niche_data_fixed[,c("response", "merlin_pool_size", "region_100km_cultivated", "region_20km_elevation_delta", "city_elevation_delta", "temperature_monthly_min")])
create_fifty_rows_of_oob(merlin_city_niche_data_fixed[,c("response", "merlin_pool_size", "region_100km_cultivated", "region_20km_elevation_delta", "city_elevation_delta", "temperature_monthly_min", "rainfall_annual_average")])
create_fifty_rows_of_oob(merlin_city_niche_data_fixed[,c("response", "merlin_pool_size", "region_100km_cultivated", "region_20km_elevation_delta", "city_elevation_delta", "temperature_monthly_min", "rainfall_annual_average", "city_mean_elevation")])
create_fifty_rows_of_oob(merlin_city_niche_data_fixed[,c("response", "merlin_pool_size", "region_100km_cultivated", "region_20km_elevation_delta", "city_elevation_delta", "temperature_monthly_min", "rainfall_annual_average", "city_mean_elevation", "temperature_annual_average")])
create_fifty_rows_of_oob(merlin_city_niche_data_fixed[,c("response", "merlin_pool_size", "region_100km_cultivated", "region_20km_elevation_delta", "city_elevation_delta", "temperature_monthly_min", "rainfall_annual_average", "city_mean_elevation", "temperature_annual_average", "herbaceous_vegetation")])
create_fifty_rows_of_oob(merlin_city_niche_data_fixed[,c("response", "merlin_pool_size", "region_100km_cultivated", "region_20km_elevation_delta", "city_elevation_delta", "temperature_monthly_min", "rainfall_annual_average", "city_mean_elevation", "temperature_annual_average", "herbaceous_vegetation", "rainfall_monthly_max")])
create_fifty_rows_of_oob(merlin_city_niche_data_fixed[,c("response", "merlin_pool_size", "region_100km_cultivated", "region_20km_elevation_delta", "city_elevation_delta", "temperature_monthly_min", "rainfall_annual_average", "city_mean_elevation", "temperature_annual_average", "herbaceous_vegetation", "rainfall_monthly_max", "percentage_urban_area_as_open_public_spaces")])
create_fifty_rows_of_oob(merlin_city_niche_data_fixed[,c("response", "merlin_pool_size", "region_100km_cultivated", "region_20km_elevation_delta", "city_elevation_delta", "temperature_monthly_min", "rainfall_annual_average", "city_mean_elevation", "temperature_annual_average", "herbaceous_vegetation", "rainfall_monthly_max", "percentage_urban_area_as_open_public_spaces", "population_growth")])
create_fifty_rows_of_oob(merlin_city_niche_data_fixed[,c("response", "merlin_pool_size", "region_100km_cultivated", "region_20km_elevation_delta", "city_elevation_delta", "temperature_monthly_min", "rainfall_annual_average", "city_mean_elevation", "temperature_annual_average", "herbaceous_vegetation", "rainfall_monthly_max", "percentage_urban_area_as_open_public_spaces", "population_growth", "region_50km_mean_elevation")])
create_fifty_rows_of_oob(merlin_city_niche_data_fixed[,c("response", "merlin_pool_size", "region_100km_cultivated", "region_20km_elevation_delta", "city_elevation_delta", "temperature_monthly_min", "rainfall_annual_average", "city_mean_elevation", "temperature_annual_average", "herbaceous_vegetation", "rainfall_monthly_max", "percentage_urban_area_as_open_public_spaces", "population_growth", "region_50km_mean_elevation", "city_gdp_per_population")])
create_fifty_rows_of_oob(merlin_city_niche_data_fixed[,c("response", "merlin_pool_size", "region_100km_cultivated", "region_20km_elevation_delta", "city_elevation_delta", "temperature_monthly_min", "rainfall_annual_average", "city_mean_elevation", "temperature_annual_average", "herbaceous_vegetation", "rainfall_monthly_max", "percentage_urban_area_as_open_public_spaces", "population_growth", "region_50km_mean_elevation", "city_gdp_per_population", "region_100km_urban")])
create_fifty_rows_of_oob(merlin_city_niche_data_fixed[,c("response", "merlin_pool_size", "region_100km_cultivated", "region_20km_elevation_delta", "city_elevation_delta", "temperature_monthly_min", "rainfall_annual_average", "city_mean_elevation", "temperature_annual_average", "herbaceous_vegetation", "rainfall_monthly_max", "percentage_urban_area_as_open_public_spaces", "population_growth", "region_50km_mean_elevation", "city_gdp_per_population", "region_100km_urban", "happiness_future_life")])
create_fifty_rows_of_oob(merlin_city_niche_data_fixed[,c("response", "merlin_pool_size", "region_100km_cultivated", "region_20km_elevation_delta", "city_elevation_delta", "temperature_monthly_min", "rainfall_annual_average", "city_mean_elevation", "temperature_annual_average", "herbaceous_vegetation", "rainfall_monthly_max", "percentage_urban_area_as_open_public_spaces", "population_growth", "region_50km_mean_elevation", "city_gdp_per_population", "region_100km_urban", "happiness_future_life", "share_of_population_within_400m_of_open_space")])
create_fifty_rows_of_oob(merlin_city_niche_data_fixed[,c("response", "merlin_pool_size", "region_100km_cultivated", "region_20km_elevation_delta", "city_elevation_delta", "temperature_monthly_min", "rainfall_annual_average", "city_mean_elevation", "temperature_annual_average", "herbaceous_vegetation", "rainfall_monthly_max", "percentage_urban_area_as_open_public_spaces", "population_growth", "region_50km_mean_elevation", "city_gdp_per_population", "region_100km_urban", "happiness_future_life", "share_of_population_within_400m_of_open_space", "happiness_positive_effect")])
```

"merlin_pool_size", "region_100km_cultivated", "region_20km_elevation_delta", "city_elevation_delta"

```{r}
birdlife_city_niche_data <- fetch_city_niche_data_for('birdlife')
birdlife_city_niche_data
```

```{r}
birdlife_city_niche_data_fixed <- rfImpute(response ~ ., birdlife_city_niche_data)
birdlife_city_niche_data_fixed
```

```{r}
select_variables_from_random_forest(birdlife_city_niche_data_fixed)
```

```{r}
exclude_birdlife_niche <- !names(birdlife_city_niche_data_fixed) %in% c(
  "region_50km_urban", "region_100km_urban",
  "region_50km_elevation_delta", "region_100km_elevation_delta", 
  "region_50km_cultivated", "region_20km_cultivated", 
  "region_20km_average_pop_density", "region_50km_average_pop_density", 
  "region_20km_includes_estuary", "region_50km_includes_estuary", "region_100km_includes_estuary", 
  "region_100km_mean_elevation", "region_20km_mean_elevation")

birdlife_city_niche_data_fixed_single_scale <- birdlife_city_niche_data_fixed[,exclude_birdlife_niche]
birdlife_city_niche_data_fixed_single_scale
```
```{r}
select_variables_from_random_forest(birdlife_city_niche_data_fixed_single_scale)
```

```{r}
create_fifty_rows_of_oob(birdlife_city_niche_data_fixed[,c("response", "region_100km_cultivated")])
create_fifty_rows_of_oob(birdlife_city_niche_data_fixed[,c("response", "region_100km_cultivated", "region_20km_elevation_delta")])
create_fifty_rows_of_oob(birdlife_city_niche_data_fixed[,c("response", "region_100km_cultivated", "region_20km_elevation_delta", "birdlife_pool_size")])
create_fifty_rows_of_oob(birdlife_city_niche_data_fixed[,c("response", "region_100km_cultivated", "region_20km_elevation_delta", "birdlife_pool_size", "happiness_future_life")])
create_fifty_rows_of_oob(birdlife_city_niche_data_fixed[,c("response", "region_100km_cultivated", "region_20km_elevation_delta", "birdlife_pool_size", "happiness_future_life", "biome_name")])
create_fifty_rows_of_oob(birdlife_city_niche_data_fixed[,c("response", "region_100km_cultivated", "region_20km_elevation_delta", "birdlife_pool_size", "happiness_future_life", "biome_name", "herbaceous_wetland")])
create_fifty_rows_of_oob(birdlife_city_niche_data_fixed[,c("response", "region_100km_cultivated", "region_20km_elevation_delta", "birdlife_pool_size", "happiness_future_life", "biome_name", "herbaceous_wetland", "temperature_annual_average")])
create_fifty_rows_of_oob(birdlife_city_niche_data_fixed[,c("response", "region_100km_cultivated", "region_20km_elevation_delta", "birdlife_pool_size", "happiness_future_life", "biome_name", "herbaceous_wetland", "temperature_annual_average", "shrubs")])
create_fifty_rows_of_oob(birdlife_city_niche_data_fixed[,c("response", "region_100km_cultivated", "region_20km_elevation_delta", "birdlife_pool_size", "happiness_future_life", "biome_name", "herbaceous_wetland", "temperature_annual_average", "shrubs", "temperature_monthly_min")])
create_fifty_rows_of_oob(birdlife_city_niche_data_fixed[,c("response", "region_100km_cultivated", "region_20km_elevation_delta", "birdlife_pool_size", "happiness_future_life", "biome_name", "herbaceous_wetland", "temperature_annual_average", "shrubs", "temperature_monthly_min", "rainfall_monthly_max")])
create_fifty_rows_of_oob(birdlife_city_niche_data_fixed[,c("response", "region_100km_cultivated", "region_20km_elevation_delta", "birdlife_pool_size", "happiness_future_life", "biome_name", "herbaceous_wetland", "temperature_annual_average", "shrubs", "temperature_monthly_min", "rainfall_monthly_max", "percentage_urban_area_as_open_public_spaces")])
create_fifty_rows_of_oob(birdlife_city_niche_data_fixed[,c("response", "region_100km_cultivated", "region_20km_elevation_delta", "birdlife_pool_size", "happiness_future_life", "biome_name", "herbaceous_wetland", "temperature_annual_average", "shrubs", "temperature_monthly_min", "rainfall_monthly_max", "percentage_urban_area_as_open_public_spaces", "share_of_population_within_400m_of_open_space")])
create_fifty_rows_of_oob(birdlife_city_niche_data_fixed[,c("response", "region_100km_cultivated", "region_20km_elevation_delta", "birdlife_pool_size", "happiness_future_life", "biome_name", "herbaceous_wetland", "temperature_annual_average", "shrubs", "temperature_monthly_min", "rainfall_monthly_max", "percentage_urban_area_as_open_public_spaces", "share_of_population_within_400m_of_open_space", "temperature_monthly_max")])
create_fifty_rows_of_oob(birdlife_city_niche_data_fixed[,c("response", "region_100km_cultivated", "region_20km_elevation_delta", "birdlife_pool_size", "happiness_future_life", "biome_name", "herbaceous_wetland", "temperature_annual_average", "shrubs", "temperature_monthly_min", "rainfall_monthly_max", "percentage_urban_area_as_open_public_spaces", "share_of_population_within_400m_of_open_space", "temperature_monthly_max", "city_elevation_delta")])
create_fifty_rows_of_oob(birdlife_city_niche_data_fixed[,c("response", "region_100km_cultivated", "region_20km_elevation_delta", "birdlife_pool_size", "happiness_future_life", "biome_name", "herbaceous_wetland", "temperature_annual_average", "shrubs", "temperature_monthly_min", "rainfall_monthly_max", "percentage_urban_area_as_open_public_spaces", "share_of_population_within_400m_of_open_space", "temperature_monthly_max", "city_elevation_delta", "rainfall_annual_average")])
create_fifty_rows_of_oob(birdlife_city_niche_data_fixed[,c("response", "region_100km_cultivated", "region_20km_elevation_delta", "birdlife_pool_size", "happiness_future_life", "biome_name", "herbaceous_wetland", "temperature_annual_average", "shrubs", "temperature_monthly_min", "rainfall_monthly_max", "percentage_urban_area_as_open_public_spaces", "share_of_population_within_400m_of_open_space", "temperature_monthly_max", "city_elevation_delta", "rainfall_annual_average", "city_mean_elevation")])
create_fifty_rows_of_oob(birdlife_city_niche_data_fixed[,c("response", "region_100km_cultivated", "region_20km_elevation_delta", "birdlife_pool_size", "happiness_future_life", "biome_name", "herbaceous_wetland", "temperature_annual_average", "shrubs", "temperature_monthly_min", "rainfall_monthly_max", "percentage_urban_area_as_open_public_spaces", "share_of_population_within_400m_of_open_space", "temperature_monthly_max", "city_elevation_delta", "rainfall_annual_average", "city_mean_elevation", "happiness_negative_effect")])
create_fifty_rows_of_oob(birdlife_city_niche_data_fixed[,c("response", "region_100km_cultivated", "region_20km_elevation_delta", "birdlife_pool_size", "happiness_future_life", "biome_name", "herbaceous_wetland", "temperature_annual_average", "shrubs", "temperature_monthly_min", "rainfall_monthly_max", "percentage_urban_area_as_open_public_spaces", "share_of_population_within_400m_of_open_space", "temperature_monthly_max", "city_elevation_delta", "rainfall_annual_average", "city_mean_elevation", "happiness_negative_effect", "region_20km_urban")])
```

"region_100km_cultivated", "region_20km_elevation_delta", "birdlife_pool_size", "happiness_future_life", "biome_name", "herbaceous_wetland"


```{r}
either_city_niche_data <- fetch_city_niche_data_for('either')
either_city_niche_data
```

```{r}
either_city_niche_data_fixed <- rfImpute(response ~ ., either_city_niche_data)
either_city_niche_data_fixed
```

```{r}
select_variables_from_random_forest(either_city_niche_data_fixed)
```
```{r}
exclude_either_niche <- !names(either_city_niche_data_fixed) %in% c(
  "region_50km_urban", "region_20km_urban",
  "region_50km_elevation_delta", "region_100km_elevation_delta", 
  "region_50km_cultivated", "region_20km_cultivated", 
  "region_20km_average_pop_density", "region_50km_average_pop_density", 
  "region_20km_includes_estuary", "region_50km_includes_estuary", "region_100km_includes_estuary", 
  "region_100km_mean_elevation", "region_20km_mean_elevation")

either_city_niche_data_fixed_single_scale <- either_city_niche_data_fixed[,exclude_either_niche]
either_city_niche_data_fixed_single_scale
```

```{r}
select_variables_from_random_forest(either_city_niche_data_fixed_single_scale)
```

```{r}
create_fifty_rows_of_oob(either_city_niche_data_fixed[,c("response", "region_100km_cultivated")])
create_fifty_rows_of_oob(either_city_niche_data_fixed[,c("response", "region_100km_cultivated", "region_20km_elevation_delta")])
create_fifty_rows_of_oob(either_city_niche_data_fixed[,c("response", "region_100km_cultivated", "region_20km_elevation_delta", "either_pool_size")])
create_fifty_rows_of_oob(either_city_niche_data_fixed[,c("response", "region_100km_cultivated", "region_20km_elevation_delta", "either_pool_size", "cultivated")])
create_fifty_rows_of_oob(either_city_niche_data_fixed[,c("response", "region_100km_cultivated", "region_20km_elevation_delta", "either_pool_size", "cultivated", "herbaceous_wetland")])
create_fifty_rows_of_oob(either_city_niche_data_fixed[,c("response", "region_100km_cultivated", "region_20km_elevation_delta", "either_pool_size", "cultivated", "herbaceous_wetland", "temperature_monthly_min")])
create_fifty_rows_of_oob(either_city_niche_data_fixed[,c("response", "region_100km_cultivated", "region_20km_elevation_delta", "either_pool_size", "cultivated", "herbaceous_wetland", "temperature_monthly_min", "temperature_annual_average")])
create_fifty_rows_of_oob(either_city_niche_data_fixed[,c("response", "region_100km_cultivated", "region_20km_elevation_delta", "either_pool_size", "cultivated", "herbaceous_wetland", "temperature_monthly_min", "temperature_annual_average", "biome_name")])
create_fifty_rows_of_oob(either_city_niche_data_fixed[,c("response", "region_100km_cultivated", "region_20km_elevation_delta", "either_pool_size", "cultivated", "herbaceous_wetland", "temperature_monthly_min", "temperature_annual_average", "biome_name", "happiness_future_life")])
create_fifty_rows_of_oob(either_city_niche_data_fixed[,c("response", "region_100km_cultivated", "region_20km_elevation_delta", "either_pool_size", "cultivated", "herbaceous_wetland", "temperature_monthly_min", "temperature_annual_average", "biome_name", "happiness_future_life", "city_elevation_delta")])
create_fifty_rows_of_oob(either_city_niche_data_fixed[,c("response", "region_100km_cultivated", "region_20km_elevation_delta", "either_pool_size", "cultivated", "herbaceous_wetland", "temperature_monthly_min", "temperature_annual_average", "biome_name", "happiness_future_life", "city_elevation_delta", "city_mean_elevation")])
create_fifty_rows_of_oob(either_city_niche_data_fixed[,c("response", "region_100km_cultivated", "region_20km_elevation_delta", "either_pool_size", "cultivated", "herbaceous_wetland", "temperature_monthly_min", "temperature_annual_average", "biome_name", "happiness_future_life", "city_elevation_delta", "city_mean_elevation", "city_gdp_per_population")])
create_fifty_rows_of_oob(either_city_niche_data_fixed[,c("response", "region_100km_cultivated", "region_20km_elevation_delta", "either_pool_size", "cultivated", "herbaceous_wetland", "temperature_monthly_min", "temperature_annual_average", "biome_name", "happiness_future_life", "city_elevation_delta", "city_mean_elevation", "city_gdp_per_population", "temperature_monthly_max")])
create_fifty_rows_of_oob(either_city_niche_data_fixed[,c("response", "region_100km_cultivated", "region_20km_elevation_delta", "either_pool_size", "cultivated", "herbaceous_wetland", "temperature_monthly_min", "temperature_annual_average", "biome_name", "happiness_future_life", "city_elevation_delta", "city_mean_elevation", "city_gdp_per_population", "temperature_monthly_max", "shrubs")])
create_fifty_rows_of_oob(either_city_niche_data_fixed[,c("response", "region_100km_cultivated", "region_20km_elevation_delta", "either_pool_size", "cultivated", "herbaceous_wetland", "temperature_monthly_min", "temperature_annual_average", "biome_name", "happiness_future_life", "city_elevation_delta", "city_mean_elevation", "city_gdp_per_population", "temperature_monthly_max", "shrubs", "rainfall_monthly_max")])
create_fifty_rows_of_oob(either_city_niche_data_fixed[,c("response", "region_100km_cultivated", "region_20km_elevation_delta", "either_pool_size", "cultivated", "herbaceous_wetland", "temperature_monthly_min", "temperature_annual_average", "biome_name", "happiness_future_life", "city_elevation_delta", "city_mean_elevation", "city_gdp_per_population", "temperature_monthly_max", "shrubs", "rainfall_monthly_max", "share_of_population_within_400m_of_open_space")])
create_fifty_rows_of_oob(either_city_niche_data_fixed[,c("response", "region_100km_cultivated", "region_20km_elevation_delta", "either_pool_size", "cultivated", "herbaceous_wetland", "temperature_monthly_min", "temperature_annual_average", "biome_name", "happiness_future_life", "city_elevation_delta", "city_mean_elevation", "city_gdp_per_population", "temperature_monthly_max", "shrubs", "rainfall_monthly_max", "share_of_population_within_400m_of_open_space", "region_50km_mean_elevation")])
create_fifty_rows_of_oob(either_city_niche_data_fixed[,c("response", "region_100km_cultivated", "region_20km_elevation_delta", "either_pool_size", "cultivated", "herbaceous_wetland", "temperature_monthly_min", "temperature_annual_average", "biome_name", "happiness_future_life", "city_elevation_delta", "city_mean_elevation", "city_gdp_per_population", "temperature_monthly_max", "shrubs", "rainfall_monthly_max", "share_of_population_within_400m_of_open_space", "region_50km_mean_elevation", "region_100km_urban")])
create_fifty_rows_of_oob(either_city_niche_data_fixed[,c("response", "region_100km_cultivated", "region_20km_elevation_delta", "either_pool_size", "cultivated", "herbaceous_wetland", "temperature_monthly_min", "temperature_annual_average", "biome_name", "happiness_future_life", "city_elevation_delta", "city_mean_elevation", "city_gdp_per_population", "temperature_monthly_max", "shrubs", "rainfall_monthly_max", "share_of_population_within_400m_of_open_space", "region_50km_mean_elevation", "region_100km_urban", "percentage_urban_area_as_open_public_spaces")])
create_fifty_rows_of_oob(either_city_niche_data_fixed[,c("response", "region_100km_cultivated", "region_20km_elevation_delta", "either_pool_size", "cultivated", "herbaceous_wetland", "temperature_monthly_min", "temperature_annual_average", "biome_name", "happiness_future_life", "city_elevation_delta", "city_mean_elevation", "city_gdp_per_population", "temperature_monthly_max", "shrubs", "rainfall_monthly_max", "share_of_population_within_400m_of_open_space", "region_50km_mean_elevation", "region_100km_urban", "percentage_urban_area_as_open_public_spaces", "open_forest")])
create_fifty_rows_of_oob(either_city_niche_data_fixed[,c("response", "region_100km_cultivated", "region_20km_elevation_delta", "either_pool_size", "cultivated", "herbaceous_wetland", "temperature_monthly_min", "temperature_annual_average", "biome_name", "happiness_future_life", "city_elevation_delta", "city_mean_elevation", "city_gdp_per_population", "temperature_monthly_max", "shrubs", "rainfall_monthly_max", "share_of_population_within_400m_of_open_space", "region_50km_mean_elevation", "region_100km_urban", "percentage_urban_area_as_open_public_spaces", "open_forest", "rainfall_monthly_min")])
```
"region_100km_cultivated", "region_20km_elevation_delta", "either_pool_size", "cultivated", "herbaceous_wetland", "temperature_monthly_min", "temperature_annual_average", "biome_name", "happiness_future_life", "city_elevation_delta", "city_mean_elevation", "city_gdp_per_population"

```{r}
both_city_niche_data <- fetch_city_niche_data_for('both')
both_city_niche_data
```

```{r}
both_city_niche_data_fixed <- rfImpute(response ~ ., both_city_niche_data)
both_city_niche_data_fixed
```

```{r}
select_variables_from_random_forest(both_city_niche_data_fixed)
```

```{r}
exclude_both_niche <- !names(both_city_niche_data_fixed) %in% c(
  "region_100km_urban", "region_20km_urban",
  "region_50km_elevation_delta", "region_100km_elevation_delta", 
  "region_50km_cultivated", "region_20km_cultivated", 
  "region_20km_average_pop_density", "region_50km_average_pop_density", 
  "region_20km_includes_estuary", "region_50km_includes_estuary", "region_100km_includes_estuary", 
  "region_100km_mean_elevation", "region_20km_mean_elevation")

both_city_niche_data_fixed_single_scale <- both_city_niche_data_fixed[,exclude_both_niche]
both_city_niche_data_fixed_single_scale
```

```{r}
select_variables_from_random_forest(both_city_niche_data_fixed_single_scale)
```

```{r}
create_fifty_rows_of_oob(both_city_niche_data_fixed[,c("response", "region_100km_cultivated")])
create_fifty_rows_of_oob(both_city_niche_data_fixed[,c("response", "region_100km_cultivated", "both_pool_size")])
create_fifty_rows_of_oob(both_city_niche_data_fixed[,c("response", "region_100km_cultivated", "both_pool_size", "temperature_monthly_min")])
create_fifty_rows_of_oob(both_city_niche_data_fixed[,c("response", "region_100km_cultivated", "both_pool_size", "temperature_monthly_min", "region_20km_elevation_delta")])
create_fifty_rows_of_oob(both_city_niche_data_fixed[,c("response", "region_100km_cultivated", "both_pool_size", "temperature_monthly_min", "region_20km_elevation_delta", "city_elevation_delta")])
create_fifty_rows_of_oob(both_city_niche_data_fixed[,c("response", "region_100km_cultivated", "both_pool_size", "temperature_monthly_min", "region_20km_elevation_delta", "city_elevation_delta", "rainfall_annual_average")])
create_fifty_rows_of_oob(both_city_niche_data_fixed[,c("response", "region_100km_cultivated", "both_pool_size", "temperature_monthly_min", "region_20km_elevation_delta", "city_elevation_delta", "rainfall_annual_average", "rainfall_monthly_max")])
create_fifty_rows_of_oob(both_city_niche_data_fixed[,c("response", "region_100km_cultivated", "both_pool_size", "temperature_monthly_min", "region_20km_elevation_delta", "city_elevation_delta", "rainfall_annual_average", "rainfall_monthly_max", "percentage_urban_area_as_open_public_spaces")])
create_fifty_rows_of_oob(both_city_niche_data_fixed[,c("response", "region_100km_cultivated", "both_pool_size", "temperature_monthly_min", "region_20km_elevation_delta", "city_elevation_delta", "rainfall_annual_average", "rainfall_monthly_max", "percentage_urban_area_as_open_public_spaces", "temperature_annual_average")])
create_fifty_rows_of_oob(both_city_niche_data_fixed[,c("response", "region_100km_cultivated", "both_pool_size", "temperature_monthly_min", "region_20km_elevation_delta", "city_elevation_delta", "rainfall_annual_average", "rainfall_monthly_max", "percentage_urban_area_as_open_public_spaces", "temperature_annual_average", "biome_name")])
create_fifty_rows_of_oob(both_city_niche_data_fixed[,c("response", "region_100km_cultivated", "both_pool_size", "temperature_monthly_min", "region_20km_elevation_delta", "city_elevation_delta", "rainfall_annual_average", "rainfall_monthly_max", "percentage_urban_area_as_open_public_spaces", "temperature_annual_average", "biome_name", "happiness_future_life")])
create_fifty_rows_of_oob(both_city_niche_data_fixed[,c("response", "region_100km_cultivated", "both_pool_size", "temperature_monthly_min", "region_20km_elevation_delta", "city_elevation_delta", "rainfall_annual_average", "rainfall_monthly_max", "percentage_urban_area_as_open_public_spaces", "temperature_annual_average", "biome_name", "happiness_future_life", "shrubs")])
create_fifty_rows_of_oob(both_city_niche_data_fixed[,c("response", "region_100km_cultivated", "both_pool_size", "temperature_monthly_min", "region_20km_elevation_delta", "city_elevation_delta", "rainfall_annual_average", "rainfall_monthly_max", "percentage_urban_area_as_open_public_spaces", "temperature_annual_average", "biome_name", "happiness_future_life", "shrubs", "percentage_urban_area_as_streets")])
create_fifty_rows_of_oob(both_city_niche_data_fixed[,c("response", "region_100km_cultivated", "both_pool_size", "temperature_monthly_min", "region_20km_elevation_delta", "city_elevation_delta", "rainfall_annual_average", "rainfall_monthly_max", "percentage_urban_area_as_open_public_spaces", "temperature_annual_average", "biome_name", "happiness_future_life", "shrubs", "percentage_urban_area_as_streets", "cultivated")])
create_fifty_rows_of_oob(both_city_niche_data_fixed[,c("response", "region_100km_cultivated", "both_pool_size", "temperature_monthly_min", "region_20km_elevation_delta", "city_elevation_delta", "rainfall_annual_average", "rainfall_monthly_max", "percentage_urban_area_as_open_public_spaces", "temperature_annual_average", "biome_name", "happiness_future_life", "shrubs", "percentage_urban_area_as_streets", "cultivated", "region_50km_urban")])
create_fifty_rows_of_oob(both_city_niche_data_fixed[,c("response", "region_100km_cultivated", "both_pool_size", "temperature_monthly_min", "region_20km_elevation_delta", "city_elevation_delta", "rainfall_annual_average", "rainfall_monthly_max", "percentage_urban_area_as_open_public_spaces", "temperature_annual_average", "biome_name", "happiness_future_life", "shrubs", "percentage_urban_area_as_streets", "cultivated", "region_50km_urban", "city_mean_elevation")])
create_fifty_rows_of_oob(both_city_niche_data_fixed[,c("response", "region_100km_cultivated", "both_pool_size", "temperature_monthly_min", "region_20km_elevation_delta", "city_elevation_delta", "rainfall_annual_average", "rainfall_monthly_max", "percentage_urban_area_as_open_public_spaces", "temperature_annual_average", "biome_name", "happiness_future_life", "shrubs", "percentage_urban_area_as_streets", "cultivated", "region_50km_urban", "city_mean_elevation", "closed_forest")])
create_fifty_rows_of_oob(both_city_niche_data_fixed[,c("response", "region_100km_cultivated", "both_pool_size", "temperature_monthly_min", "region_20km_elevation_delta", "city_elevation_delta", "rainfall_annual_average", "rainfall_monthly_max", "percentage_urban_area_as_open_public_spaces", "temperature_annual_average", "biome_name", "happiness_future_life", "shrubs", "percentage_urban_area_as_streets", "cultivated", "region_50km_urban", "city_mean_elevation", "closed_forest", "herbaceous_wetland")])
create_fifty_rows_of_oob(both_city_niche_data_fixed[,c("response", "region_100km_cultivated", "both_pool_size", "temperature_monthly_min", "region_20km_elevation_delta", "city_elevation_delta", "rainfall_annual_average", "rainfall_monthly_max", "percentage_urban_area_as_open_public_spaces", "temperature_annual_average", "biome_name", "happiness_future_life", "shrubs", "percentage_urban_area_as_streets", "cultivated", "region_50km_urban", "city_mean_elevation", "closed_forest", "herbaceous_wetland", "happiness_negative_effect")])
create_fifty_rows_of_oob(both_city_niche_data_fixed[,c("response", "region_100km_cultivated", "both_pool_size", "temperature_monthly_min", "region_20km_elevation_delta", "city_elevation_delta", "rainfall_annual_average", "rainfall_monthly_max", "percentage_urban_area_as_open_public_spaces", "temperature_annual_average", "biome_name", "happiness_future_life", "shrubs", "percentage_urban_area_as_streets", "cultivated", "region_50km_urban", "city_mean_elevation", "closed_forest", "herbaceous_wetland", "happiness_negative_effect", "share_of_population_within_400m_of_open_space")])
create_fifty_rows_of_oob(both_city_niche_data_fixed[,c("response", "region_100km_cultivated", "both_pool_size", "temperature_monthly_min", "region_20km_elevation_delta", "city_elevation_delta", "rainfall_annual_average", "rainfall_monthly_max", "percentage_urban_area_as_open_public_spaces", "temperature_annual_average", "biome_name", "happiness_future_life", "shrubs", "percentage_urban_area_as_streets", "cultivated", "region_50km_urban", "city_mean_elevation", "closed_forest", "herbaceous_wetland", "happiness_negative_effect", "share_of_population_within_400m_of_open_space", "temperature_monthly_max")])
```
"region_100km_cultivated", "both_pool_size", "temperature_monthly_min", "region_20km_elevation_delta", "city_elevation_delta"

------------------------------------------
So....
------------------------------------------
"merlin_pool_size", "region_100km_cultivated", "region_20km_elevation_delta", "city_elevation_delta"
"region_100km_cultivated", "region_20km_elevation_delta", "birdlife_pool_size", "happiness_future_life", "biome_name", "herbaceous_wetland"
"region_100km_cultivated", "region_20km_elevation_delta", "either_pool_size", "cultivated", "herbaceous_wetland", "temperature_monthly_min", "temperature_annual_average", "biome_name", "happiness_future_life", "city_elevation_delta", "city_mean_elevation", "city_gdp_per_population"
"region_100km_cultivated", "both_pool_size", "temperature_monthly_min", "region_20km_elevation_delta", "city_elevation_delta"

```{r}
ggplot() + 
  geom_point(aes(x = merlin_pool_size, y = response), merlin_city_niche_data_fixed, color = "red") +
  geom_point(aes(x = birdlife_pool_size, y = response), birdlife_city_niche_data_fixed, color = "blue") +
  geom_point(aes(x = either_pool_size, y = response), either_city_niche_data_fixed, color = "green") +
  geom_point(aes(x = both_pool_size, y = response), both_city_niche_data_fixed, color = "purple")
```
```{r}
ggplot() + 
  geom_point(aes(x = region_100km_cultivated, y = response), merlin_city_niche_data_fixed, color = "red") +
  geom_point(aes(x = region_100km_cultivated, y = response), birdlife_city_niche_data_fixed, color = "blue") +
  geom_point(aes(x = region_100km_cultivated, y = response), either_city_niche_data_fixed, color = "green") +
  geom_point(aes(x = region_100km_cultivated, y = response), both_city_niche_data_fixed, color = "purple")
```
```{r}
ggplot() + 
  geom_point(aes(x = region_20km_elevation_delta, y = response), merlin_city_niche_data_fixed, color = "red") +
  geom_point(aes(x = region_20km_elevation_delta, y = response), birdlife_city_niche_data_fixed, color = "blue") +
  geom_point(aes(x = region_20km_elevation_delta, y = response), either_city_niche_data_fixed, color = "green") +
  geom_point(aes(x = region_20km_elevation_delta, y = response), both_city_niche_data_fixed, color = "purple")
```
```{r}
ggplot() + 
  geom_point(aes(x = city_elevation_delta, y = response), merlin_city_niche_data_fixed, color = "red") +
  geom_point(aes(x = city_elevation_delta, y = response), birdlife_city_niche_data_fixed, color = "blue") +
  geom_point(aes(x = city_elevation_delta, y = response), either_city_niche_data_fixed, color = "green") +
  geom_point(aes(x = city_elevation_delta, y = response), both_city_niche_data_fixed, color = "purple")
```

```{r}
ggplot() + 
  geom_point(aes(x = temperature_monthly_min, y = response), merlin_city_niche_data_fixed, color = "red") +
  geom_point(aes(x = temperature_monthly_min, y = response), birdlife_city_niche_data_fixed, color = "blue") +
  geom_point(aes(x = temperature_monthly_min, y = response), either_city_niche_data_fixed, color = "green") +
  geom_point(aes(x = temperature_monthly_min, y = response), both_city_niche_data_fixed, color = "purple")
```

```{r}
ggplot() + 
  geom_point(aes(x = herbaceous_wetland, y = response), merlin_city_niche_data_fixed, color = "red") +
  geom_point(aes(x = herbaceous_wetland, y = response), birdlife_city_niche_data_fixed, color = "blue") +
  geom_point(aes(x = herbaceous_wetland, y = response), either_city_niche_data_fixed, color = "green") +
  geom_point(aes(x = herbaceous_wetland, y = response), both_city_niche_data_fixed, color = "purple")
```

```{r}
ggplot() + 
  geom_point(aes(x = happiness_future_life, y = response), merlin_city_niche_data_fixed, color = "red") +
  geom_point(aes(x = happiness_future_life, y = response), birdlife_city_niche_data_fixed, color = "blue") +
  geom_point(aes(x = happiness_future_life, y = response), either_city_niche_data_fixed, color = "green") +
  geom_point(aes(x = happiness_future_life, y = response), both_city_niche_data_fixed, color = "purple")
```
```{r}
ggplot() + 
  geom_boxplot(aes(x = response, y = biome_name), merlin_city_niche_data_fixed)
```

```{r}
ggplot() + 
  geom_boxplot(aes(x = response, y = biome_name), birdlife_city_niche_data_fixed)
```

```{r}
ggplot() + 
  geom_boxplot(aes(x = response, y = biome_name), either_city_niche_data_fixed)
```

```{r}
ggplot() + 
  geom_boxplot(aes(x = response, y = biome_name), both_city_niche_data_fixed)
```

